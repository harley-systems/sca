# this is the open ssl configuation file that is used for creating the root ca certificate
####################################################################
# enable FIPS
####################################################################
#
# as described at https://www.openssl.org/docs/manmaster/man5/config.html

# Default appname: should match "appname" parameter (if any)
# supplied to CONF_modules_load_file et al.
openssl_conf                = openssl_conf_section
#################################################
# defaults
[default]
#################################################
# settings - set defaults - options
# the currently selected CA authority (short, small caps) name
name                        = '$name_default'
# the currently selected CA authority long (small and big caps) name
caps_name                   = '$caps_name_default'
# the DNS domain for the currently selected CA authority
domain                      = '$domain_default'
# the name of the currently subca (a person trusted to issue signed certificates)
subca                       = '$subca_default'
#
subca_name                  = '$subca_name_default'
#
subca_surname               = '$subca_surname_default'
#
subca_given_name            = '$subca_given_name_default'
#
subca_initials              = '$subca_initials_default'
# the currently selected service name
service                     = '$service_default'
# the currently selected host name
host                        = '$host_default'
# the currently selected user name
user                        = '$user_default'
#
user_name                   = '$user_name_default'
#
user_surname                = '$user_surname_default'
#
user_given_name             = '$user_given_name_default'
#
user_initials               = '$user_initials_default'
# file name suffix to attach to CA related file names
suffix                      = '$suffix_default'
# the suffix to use in certificates for certificate authority name
caps_suffix                 = "'$caps_suffix_default'"
#################################################
# settings -  set defaults - folder settings
# the folder that is removable storage mount point for keeping the CA private
# keys and other sensitive information
key_folder                  = '$key_folder_default'
#
pkcs11_engine               = '$pkcs11_engine_default'
#
opensc_pkcs11_module        = '$opensc_pkcs11_module_default'
#
ykcs11_module               = '$ykcs11_module_default'
#################################################
# settings -  load from environment
# as described at https://www.openssl.org/docs/manmaster/man5/config.html
# we first set a variable to a value ..
# if the same name environment variable is not defined, the above specified values
# are used in following expressions
name                        = ${ENV::name}
caps_name                   = ${ENV::caps_name}
domain                      = ${ENV::domain}
subca                       = ${ENV::subca}
subca_name                  = ${ENV::subca_name}
subca_surname               = ${ENV::subca_surname}
subca_given_name            = ${ENV::subca_given_name}
subca_initials              = ${ENV::subca_initials}
service                     = ${ENV::service}
host                        = ${ENV::host}
user                        = ${ENV::user}
user_name                   = ${ENV::user_name}
user_surname                = ${ENV::user_surname}
user_given_name             = ${ENV::user_given_name}
user_initials               = ${ENV::user_initials}
suffix                      = ${ENV::suffix}
caps_suffix                 = ${ENV::caps_suffix}
key_folder                  = ${ENV::key_folder}
pkcs11_engine               = ${ENV::pkcs11_engine}
opensc_pkcs11_module        = ${ENV::opensc_pkcs11_module}
ykcs11_module               = ${ENV::ykcs11_module}

#########################################################
# settings - calculate derived
#################################################
# derived settings
# below settings are derived from values of the settings above accordig to
# nameing convention described in README.md
# the full dns domain name for the CA authority
full_domain                 = ${name}${domain}
#
local_domain                = cluster.local
# prefix to use in certificates for generated common names
common_name_prefix          = ${caps_name} ${caps_suffix}
#################################################
# derived folder settings
################################################
# ca related folders and files locations
# the CA data relative folder (within key_folder) for currently selected authority (name setting)
ca_files_relative_folder    = ${name}/
# the CA data root folder for currently selected authority (name setting)
ca_files_folder             = ${key_folder}${ca_files_relative_folder}
# the prefix to use for the root ca related files (including full path)
ca_file_prefix              = ${name}${suffix}ca-
# the prefix to use for the root ca related files (not including full path)
ca_filename_relative_prefix = ${ca_files_relative_folder}${ca_file_prefix}
# the prefix to use for the root ca related files (including full path)
ca_filename_prefix          = ${ca_files_folder}${ca_file_prefix}
# the folder that will hold private ca files
ca_private_folder           = ${ca_files_folder}private/
# the prefix to use for the root ca private (secret) related files (including
# full path)
ca_private_filename_prefix  = ${ca_private_folder}${ca_file_prefix}
# ! name of the selected root ca authority key file
ca_key_file                 = ${ca_private_filename_prefix}key.pem
# ! name of the selected root ca authority certificate file
ca_crt_file                 = ${ca_filename_prefix}crt.pem
#
ca_crt_relative_file        = ${ca_filename_relative_prefix}.crt
# name of the selected subca certificate signing request file
ca_csr_file                 = ${ca_filename_prefix}csr.pem
# (not used ?) name of the selected root ca authority certificate signature
# request signing configuration file
ca_csr_ini_file             = ${ca_filename_prefix}csr.ini
# (not used ?) name of the selected root ca authority certificate extensions
# configuration file
ca_crt_ini_file             = ${ca_filename_prefix}crt.ini
# !
ca_database_file            = ${ca_filename_prefix}db.txt
# !
ca_new_certs_dir            = ${ca_files_folder}newcerts
# !
ca_serial_file              = ${ca_filename_prefix}srl.txt
# !
ca_rand_file                = ${ca_filename_prefix}rnd.txt
# !
ca_crl_serial_file          = ${ca_filename_prefix}crl-srl.txt
# !
ca_crl_file                 = ${ca_filename_prefix}crl.pem
#
ca_crl_relative_file        = ${ca_filename_relative_prefix}crl.pem
# !
ca_crl_uri                  = http://crl.${full_domain}/${ca_crl_relative_file}
#
ca_crt_uri                  = http://crl.${full_domain}/${ca_crt_relative_file}
#
ca_ocsp_uri                 = http://ocsp.${full_domain}
################################################
# subca related folders and files locations
subca_files_relative_folder  = ${ca_files_relative_folder}${subca}/
# folder containing the subca related files
subca_files_folder          = ${ca_files_folder}${subca}/
# the prefix to use for the subca related files (including full path)
subca_file_prefix           = ${name}${suffix}${subca}-subca-
# the prefix to use for the root ca related files (not including full path)
subca_filename_relative_prefix  = ${subca_files_relative_folder}${subca_file_prefix}
# the prefix to use for the subca related files (including full path)
subca_filename_prefix       = ${subca_files_folder}${subca_file_prefix}
#
subca_private_folder        = ${subca_files_folder}private/
# the prefix to use for the subca private (secret) related files (including
# full path)
subca_private_filename_prefix = ${subca_private_folder}${subca_file_prefix}
#
subca_yubikey_key_file      = ${subca_private_filename_prefix}key.txt
#
subca_yubikey_pin_file      = ${subca_private_filename_prefix}pin.txt
#
subca_yubikey_puk_file      = ${subca_private_filename_prefix}puk.txt
# name of the selected subca authority key file
subca_key_file              = ${subca_private_filename_prefix}key.pem
# name of the selected subca authority certificate file
subca_crt_file              = ${subca_filename_prefix}crt.pem
#
subca_crt_relative_file     = ${subca_filename_relative_prefix}.crt
# name of the selected subca certificate signing request file
subca_csr_file              = ${subca_filename_prefix}csr.pem
# name of the selected subca authority certificate signature request signing
# configuration file
subca_csr_ini_file          = ${subca_filename_prefix}csr.ini
# name of the selected subca authority certificate extensions configuration
# file
subca_crt_ini_file          = ${subca_filename_prefix}crt.ini
#
subca_database_file         = ${subca_filename_prefix}db.txt
#
subca_new_certs_dir         = ${subca_files_folder}newcerts
#
subca_serial_file           = ${subca_filename_prefix}srl.txt
#
subca_rand_file             = ${subca_private_filename_prefix}rnd.txt
#
subca_crl_serial_file       = ${subca_filename_prefix}crl-srl.txt
#
subca_crl_file              = ${subca_filename_prefix}crl.pem
#
subca_crl_relative_file     = ${subca_filename_relative_prefix}crl.pem
#
subca_crl_uri               = http://crl.${full_domain}/${subca_crl_relative_file}
#
subca_crt_uri               = http://crl.${full_domain}/${subca_crt_relative_file}
#
subca_ocsp_uri              = http://ocsp.${full_domain}/${subca}
################################################
# service related folders and files locations
# folder containing the services related files
services_root_relative_folder = ${subca_files_relative_folder}services/
#
services_root_folder        = ${subca_files_folder}services/
#
service_files_relative_folder = ${services_root_relative_folder}{service}/
# the prefix to use for the services related files (including full path)
service_files_folder        = ${services_root_folder}${service}/
# the prefix to use for the service related files (including full path)
service_file_prefix         = ${name}${suffix}${subca}-${service}-
#
serice_filename_relative_prefix = ${service_files_relative_folder}${service_file_prefix}
# the prefix to use for the service related files (including full path)
service_filename_prefix     = ${service_files_folder}${service_file_prefix}
#
service_private_folder      = ${service_files_folder}private/
# the prefix to use for the service private (secret) related files (including
# full path)
service_private_filename_prefix = ${service_private_folder}${service_file_prefix}
# name of the selected service key file
service_key_file            = ${service_private_filename_prefix}key.pem
# name of the selected service certificate file
service_crt_file            = ${service_filename_prefix}crt.pem
#
service_crt_relative_file   = ${serice_filename_relative_prefix}crt.pem
# name of the selected service certificate signing request file
service_csr_file            = ${service_filename_prefix}csr.pem
# name of the selected service certificate signature request signing
# configuration file
service_csr_ini_file        = ${service_filename_prefix}csr.ini
# name of the selected service certificate extensions configuration
# file
service_crt_ini_file        = ${service_filename_prefix}crt.ini
# the service full dns name
service_dns_name            = ${service}.${full_domain}
#
service_local_dns_name      = ${service}.${local_domain}
################################################
# host related folders and files locations
#
hosts_root_relative_folder = ${subca_files_relative_folder}hosts/
#
hosts_root_folder           = ${subca_files_folder}hosts/
#
host_files_relative_folder  = ${hosts_root_relative_folder}${host}/
#
host_files_folder           = ${hosts_root_folder}${host}/
#
host_file_prefix            = ${name}${suffix}${subca}-${host}-
#
host_filename_relative_prefix = ${host_files_relative_folder}${host_file_prefix}
#
host_filename_prefix        = ${host_files_folder}${host_file_prefix}
#
host_private_folder         = ${host_files_folder}private/
#
host_private_filename_prefix = ${host_private_folder}${host_file_prefix}
#
host_key_file               = ${host_private_filename_prefix}key.pem
#
host_crt_file               = ${host_filename_prefix}crt.pem
#
host_crt_relative_file      = ${host_filename_relative_prefix}crt.pem
#
host_csr_file               = ${host_filename_prefix}csr.pem
#
host_csr_ini_file           = ${host_filename_prefix}csr.ini
#
host_crt_ini_file           = ${host_filename_prefix}crt.ini
################################################
# user related folders and files locations
#
users_root_relative_folder = ${subca_files_relative_folder}users/
#
users_root_folder           = ${subca_files_folder}users/
#
user_files_relative_folder = ${users_root_relative_folder}${user}/
#
user_files_folder           = ${users_root_folder}${user}/
#
user_file_prefix            = ${name}${suffix}${subca}-${user}-
#
user_filename_relative_prefix = ${user_files_relative_folder}${user_file_prefix}
#
user_filename_prefix        = ${user_files_folder}${user_file_prefix}
#
user_private_folder         = ${user_files_folder}private/
#
user_private_filename_prefix = ${user_private_folder}${user_file_prefix}
#
user_key_file               = ${user_private_filename_prefix}key.pem
#
user_crt_file               = ${user_filename_prefix}crt.pem
#
user_crt_relative_file      = ${user_filename_relative_prefix}crt.pem
#
user_csr_file               = ${user_filename_prefix}csr.pem
#
user_csr_ini_file           = ${user_filename_prefix}csr.ini
#
user_crt_ini_file           = ${user_filename_prefix}crt.ini
####################################################################
#
[ openssl_conf_section ]
# reference to section on algorithms
alg_section                 = evp_section
#PKCS11-BLOCK
####################################################################
#
[ evp_section ]
# Set to "yes" to enter FIPS mode if supported
fips_mode                   = no
####################################################################
# ca definition
[ ca ]
default_ca  = ca
# the text database file to use. Mandatory. This file must be present though
# initially it will be empty.
database                    = ${ca_database_file}
# specifies the directory where new certificates will be placed. Mandatory.
new_certs_dir               = ${ca_new_certs_dir}
# text file containing the next serial number to use in hex. Mandatory.
# this file must be present and contain a valid serial number.
# the serial number which the CA is currently at.
# according to https://www.phildev.net/ssl/creating_ca.html
# you should not initialize this with a number! instead, use the -create_serial
# option when creating root ca crt (openssl ca) -create_serial parameter is
# especially important. Many HOW-TOs will have you echo "01"
# into the serial filkeye thus starting the serial number at 1, and using 8-bit
# serial numbers instead of 128-bit serial numbers. This will generate a random
# 128-bit serial number to start with. The randomness helps to ensure that if
# you make a mistake and start over, you won''t overwrite existing serial numbers
# out there.
serial                      = ${ca_serial_file}
# the file containing the CA certificate. Mandatory
certificate                 = ${ca_crt_file}
# the file contaning the CA private key. Mandatory
private_key                 = ${ca_key_file}
# a file used to read and write random number seed information, or an EGD
# socket (see RAND_egd).
RANDFILE                    = ${ca_rand_file}
# a text file containing the next CRL number to use in hex. The crl number will
# be inserted in the CRLs only if this file exists. If this file is present,
# it must contain a valid CRL number.
crlnumber                   = ${ca_crl_serial_file}
# The current CRL
crl                         = ${ca_crl_file}
# This specifies a file containing additional OBJECT IDENTIFIERS . Each line of
# the file should consist of the numerical form of the object identifier
# followed by white space then the short name followed by white space and
# finally the long name.
# oid_file        = $dir/root-ca-oids
#############################################################################
# root ca parameter settings
# the message digest algorithm. Mandatory. Remember to not use MD5
# sha256 is also deprecated.
default_md                  = sha512
# The number of days to certify a certificate for.
default_days                = 3650
# how long before next CRL
default_crl_days            = 10
# these options allow the format used to display the certificate details when
# asking the user to confirm signing. All the options supported by the x509
# utilities -nameopt and -certopt switches can be used here, except the
# no_signame and no_sigdump are permanently set and cannot be disabled
# (this is because the certificate signature cannot be displayed because the
# certificate has not been signed at this point).
# For convenience the values ca_default are accepted by both to produce a
# reasonable output.
# If neither option is present the format used in earlier versions of OpenSSL
# is used. Use of the old format is strongly discouraged because it only
# displays fields mentioned in the policy section, mishandles multicharacter
# string types and does not display extensions.
# Comment out the following two entries for the "traditional" (and highly broken)
# format.
# Subject Name options
name_opt                    = ca_default
# Certificate field options
cert_opt                    = ca_default
# keep passed DN ordering
preserve                    = yes
#
unique_subject              = no
# Honor extensions requested of us
# alternative setting
# copy_extensions = none
copy_extensions	            = copyall
###############################################################################
# references to additional related configuration sections related to root ca
# By default we use "user certificate" extensions when signing
# The extentions to add to the cert
x509_extensions             = subca_with_san_ext
# Extensions to add to a CRL. Note: Netscape communicator chokes on V2 CRLs
# so this is commented out by default to leave a V1 CRL.
# crlnumber must also be commented out to leave a V1 CRL.
crl_extensions              = crl_ext
# a section with a set of variables corresponding to DN fields
# A few difference way of specifying how similar the request should look
# For type CA, the listed attributes must be the same, and the optional
# and supplied fields are just that :-)
policy                      = policy_c_o_match
# This specifies a section in the configuration file containing extra object
# identifiers. Each line should consist of the short name of the object
# identifier followed by = and the numerical form. The short and long names are
# the same when this option is used.
# oid_section     = ca_oid
####################################################################
# subca definition
[ subca ]
database                    = ${subca_database_file}
new_certs_dir               = ${subca_new_certs_dir}
serial                      = ${subca_serial_file}
certificate                 = ${subca_crt_file}
private_key                 = ${subca_key_file}
RANDFILE                    = ${subca_rand_file}
crlnumber                   = ${subca_crl_serial_file}
crl                         = ${subca_crl_file}
default_md                  = sha512
default_days                = 3650
default_crl_days            = 10
name_opt                    = ca_default
cert_opt                    = ca_default
preserve                    = no
unique_subject              = no
copy_extensions	            = copy
x509_extensions             = usr_cert
crl_extensions              = crl_ext
policy                      = policy_c_o_match
# oid_section               = subca_oid
####################################################################
# policy country and organization match
[policy_c_o_match]
#
countryName                 = match
#
stateOrProvinceName         = optional
#
organizationName            = match
#
organizationalUnitName      = optional
#
commonName                  = supplied
#
emailAddress                = optional
####################################################################
# strict policy
[ policy_strict ]
# The root CA should only sign intermediate certificates that match.
# See the POLICY FORMAT section of ''ca'' man page.
#
countryName                 = match
#
stateOrProvinceName         = match
#
organizationName            = match
#
organizationalUnitName      = optional
#
commonName                  = supplied
#
emailAddress                = supplied
####################################################################
# loose policy
[ policy_loose ]
# Allow the intermediate CA to sign a more diverse range of certificates.
# See the POLICY FORMAT section of the ''ca'' man page.
#
countryName                 = optional
#
stateOrProvinceName         = optional
#
localityName                = optional
#
organizationName            = optional
#
organizationalUnitName      = optional
#
commonName                  = supplied
#
emailAddress                = optional
###############################################################################
# root ca crl extensions
[ crl_ext ]
# Extension for CRLs (''man x509v3_config'').
authorityKeyIdentifier      = keyid:always
###############################################################################
# root ca crl distribution point
#
# for multiple distribution points, use ca_crls and
# reffer to it with @ca_crls in
# crlDistributionPoints setting of [ ca_cert ] section
[ ca_crls ]
#
URI.1 = ca_crl
# list multiple urls if there are additional crls to include
#URI.2 = ldap://www.example.com/ldap?DN=TEST
####################################################################
# list of different crls related to subca
[ subca_crls ]
#
URI.1 = ca_crl
#
URI.2 = subca_crl
####################################################################
# definition of slingle crl for ca
[ ca_crl ]
#
fullname = @ca_crl_uris
####################################################################
# definition of slingle crl for subca
[ subca_crl ]
#
fullname = @subca_crl_uris
###############################################################################
# single root ca crl distrubution point uri list
[ ca_crl_uris ]
#
URI.1 = ${ca_crl_uri}
# list multiple urls if same crl is available at multiple end points
#URI.2 = ldap://www.example.com/ldap?DN=TEST
[ subca_crl_uris ]
#
URI.1 = ${subca_crl_uri}
# list multiple urls if same crl is available at multiple end points
#URI.2 = ldap://www.example.com/ldap?DN=TEST
###############################################################################
# subca crls
# we use multiple crls - the ones from the root ca and the ones by the subca
[subca_crls]
#
URI.1 = ca_crl_uris
#
URI.2 = subca_crl_uris
###############################################################################
# ca naming constraints
[ ca_nc ]
#
#permitted;otherName=1.3.6.1.5.5.7.8.7;IA5:${full_domain}
#
permitted;email.0=${full_domain}
#
permitted;email.1=.${full_domain}
#
permitted;DNS.0=${full_domain}
#
permitted;DNS.1=.${full_domain}
#
permitted;DNS.2=${local_domain}
#
permitted;DNS.3=.${local_domain}
#
permitted;URI.0=${full_domain}
#
permitted;URI.1=.${full_domain}
#
permitted;URI.2=${local_domain}
#
permitted;URI.3=.${local_domain}
#
permitted;IP.0=0.0.0.0/255.255.255.255
#
permitted;IP.1=::/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
#
#excluded;IP.0=0.0.0.0/0.0.0.0
#
#excluded;IP.1=0:0:0:0:0:0:0:0/0:0:0:0:0:0:0:0
###############################################################################
# subca naming constraints
[ subca_nc ]
#
#permitted;otherName=1.3.6.1.5.5.7.8.7;IA5:${full_domain}
#
permitted;email.0=${full_domain}
#
permitted;email.1=.${full_domain}
#
permitted;DNS.0=${full_domain}
#
permitted;DNS.1=.${full_domain}
#
permitted;DNS.2=${local_domain}
#
permitted;DNS.3=.${local_domain}
#
permitted;URI.0=${full_domain}
#
permitted;URI.1=.${full_domain}
#
permitted;URI.2=${local_domain}
#
permitted;URI.3=.${local_domain}
#
permitted;IP.0=0.0.0.0/255.255.255.255
#
permitted;IP.1=::/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
###############################################################################
# host naming constraints
[ host_nc ]
#
#permitted;otherName=1.3.6.1.5.5.7.8.7;IA5:${full_domain}
#
permitted;email.0=${full_domain}
#
permitted;email.1=.${full_domain}
#
permitted;DNS.0=${full_domain}
#
permitted;DNS.1=.${full_domain}
#
permitted;URI.0=${full_domain}
#
permitted;URI.1=.${full_domain}
#
permitted;IP.0=0.0.0.0/255.255.255.255
#
permitted;IP.1=::/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
###############################################################################
# service naming constraints
[ service_nc ]
#
#permitted;otherName=1.3.6.1.5.5.7.8.7;IA5:${full_domain}
#
permitted;email.0=${full_domain}
#
permitted;email.1=.${full_domain}
#
permitted;DNS.0=${service_dns_name}
#
permitted;DNS.1=.${service_dns_name}
#
permitted;DNS.2=${service_local_dns_name}
#
permitted;DNS.3=.${service_local_dns_name}
#
permitted;URI.0=${service_dns_name}
#
permitted;URI.1=.${service_dns_name}
#
permitted;URI.2=${service_local_dns_name}
#
permitted;URI.3=.${service_local_dns_name}
#
permitted;IP.0=0.0.0.0/255.255.255.255
#
permitted;IP.1=::/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
###############################################################################
# user naming constraints
[ user_nc ]
#
#permitted;otherName=1.3.6.1.5.5.7.8.7;IA5:${full_domain}
#
permitted;email.0=${full_domain}
#
permitted;email.1=.${full_domain}
#
permitted;DNS.0=${full_domain}
#
permitted;DNS.1=.${full_domain}
#
permitted;DNS.2=${local_domain}
#
permitted;DNS.3=.${local_domain}
#
permitted;URI.0=${full_domain}
#
permitted;URI.1=.${full_domain}
#
permitted;URI.2=${local_domain}
#
permitted;URI.3=.${local_domain}
#
permitted;IP.0=0.0.0.0/255.255.255.255
#
permitted;IP.1=::/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
###############################################################################
# ca issuer info
[ ca_issuer_info ]
#
caIssuers;URI.0         = ${ca_crt_uri}
#
OCSP;URI.0              = ${ca_ocsp_uri}
###############################################################################
# subca issuer info
[ subca_issuer_info ]
#
caIssuers;URI.0         = ${subca_crt_uri}
#
OCSP;URI.0              = ${ca_ocsp_uri}
#
OCSP;URI.1              = ${subca_ocsp_uri}
##############################################################################
# extensions for ca when requesting and self-signing the ca cert-man x509v3_config
[ ca_ext ]
basicConstraints            = critical, CA:true
# nsCertType                  = client, email, objsign
nsComment                   = "CA Certificate"
keyUsage                    = critical, digitalSignature, cRLSign, keyCertSign
subjectKeyIdentifier        = hash
#authorityKeyIdentifier      = keyid:always, issuer:always
crlDistributionPoints       = @ca_crl_uris
#extendedKeyUsage            = clientAuth, emailProtection
extendedKeyUsage            = serverAuth, clientAuth
nameConstraints             = @ca_nc
authorityInfoAccess         = @ca_issuer_info
# This stuff is for subjectAltName and issuerAltname.
# Import the email address.
#subjectAltName=email:copy
# An alternative to produce certificates that aren''t
# deprecated according to PKIX.
subjectAltName              = email:move
##############################################################################
# extensions for ca when requesting and self-signing the ca cert-man x509v3_config
# Same as above, but cert req already has SubjectAltName
[ ca_with_san_ext ]
basicConstraints            = critical, CA:true
# nsCertType                  = client, email, objsign
nsComment                   = "CA Certificate"
keyUsage                    = critical, digitalSignature, cRLSign, keyCertSign
subjectKeyIdentifier        = hash
authorityKeyIdentifier      = keyid:always, issuer:always
crlDistributionPoints       = @ca_crl_uris
# extendedKeyUsage            = clientAuth, emailProtection
extendedKeyUsage            = serverAuth, clientAuth
nameConstraints             = @ca_nc
authorityInfoAccess         = @ca_issuer_info
##############################################################################
# extensions for subca when signing user certs as well as for users when
# requesting cert - man x509v3_config
[ subca_ext ]
basicConstraints            = critical, CA:true, pathlen:1
# nsCertType                  = client, email, objsign
nsComment                   = "SubCA Certificate"
keyUsage                    = critical, digitalSignature, cRLSign, keyCertSign
subjectKeyIdentifier        = hash
#authorityKeyIdentifier      = keyid:always, issuer:always
crlDistributionPoints       = @subca_crl_uris
# extendedKeyUsage            = clientAuth, emailProtection
extendedKeyUsage            = serverAuth, clientAuth
# nameConstraints disabled - OpenWrt strongswan does not support all constraint types
#nameConstraints             = @subca_nc
authorityInfoAccess         = @ca_issuer_info
# This stuff is for subjectAltName and issuerAltname.
# Import the email address.
#subjectAltName=email:copy
# An alternative to produce certificates that aren''t
# deprecated according to PKIX.
subjectAltName              = email:move
#issuerAltName               = issuer:copy
##############################################################################
# extensions for subca when signing user certs as well as for users when
# requesting cert - man x509v3_config
# Same as above, but cert req already has SubjectAltName
[subca_with_san_ext]
basicConstraints            = critical, CA:true, pathlen:1
# nsCertType                  = client, email, objsign
nsComment                   = "SubCA Certificate"
keyUsage                    = critical, digitalSignature, cRLSign, keyCertSign
subjectKeyIdentifier        = hash
authorityKeyIdentifier      = keyid:always, issuer:always
crlDistributionPoints       = @subca_crl_uris
# extendedKeyUsage            = clientAuth, emailProtection
extendedKeyUsage            = serverAuth, clientAuth
# nameConstraints disabled - OpenWrt strongswan does not support all constraint types
#nameConstraints             = @subca_nc
authorityInfoAccess         = @ca_issuer_info
#issuerAltName               = issuer:copy
##############################################################################
# extensions for subca when signing host certs as well as for users when
# requesting cert - man x509v3_config
[host_ext]
basicConstraints            = CA:false
nsCertType                  = server
nsComment                   = "Host Certificate"
keyUsage                    = critical, digitalSignature, keyEncipherment
subjectKeyIdentifier        = hash
# authorityKeyIdentifier      = keyid:always, issuer:always
crlDistributionPoints       = @subca_crl_uris
extendedKeyUsage            = serverAuth
# nameConstraints removed - RFC 5280 §4.2.1.10: must only appear in CA certs
#nameConstraints             = critical, @host_nc
authorityInfoAccess         = @subca_issuer_info
# This stuff is for subjectAltName and issuerAltname.
# Import the email address.
#subjectAltName=email:copy
# An alternative to produce certificates that aren''t
# deprecated according to PKIX.
subjectAltName              = email:move
#issuerAltName               = issuer:copy
###############################################
# extensions for subca when signing host certs as well as for users when
# requesting cert - man x509v3_config
# Same as above, but cert req already has SubjectAltName
[host_with_san_ext]
basicConstraints            = CA:false
nsCertType                  = server
nsComment                   = "Host Certificate"
keyUsage                    = critical, digitalSignature, keyEncipherment
subjectKeyIdentifier        = hash
#authorityKeyIdentifier      = keyid:always, issuer:always
crlDistributionPoints       = @subca_crl_uris
extendedKeyUsage            = serverAuth
# nameConstraints removed - RFC 5280 §4.2.1.10: must only appear in CA certs
#nameConstraints             = critical, @host_nc
authorityInfoAccess         = @subca_issuer_info
#issuerAltName               = issuer:copy
##############################################################################
# extensions for subca when signing service certs as well as for users when
# requesting cert - man x509v3_config
[service_ext]
basicConstraints            = CA:false
nsCertType                  = server
nsComment                   = "Service Certificate"
keyUsage                    = critical, digitalSignature, keyEncipherment
subjectKeyIdentifier        = hash
#authorityKeyIdentifier      = keyid:always, issuer:always
crlDistributionPoints       = @subca_crl_uris
extendedKeyUsage            = serverAuth
# nameConstraints removed - RFC 5280 §4.2.1.10: must only appear in CA certs
#nameConstraints             = @service_nc
authorityInfoAccess         = @subca_issuer_info
# This stuff is for subjectAltName and issuerAltname.
# Import the email address.
#subjectAltName=email:copy
# An alternative to produce certificates that aren''t
# deprecated according to PKIX.
subjectAltName              = @service_alt_names
#issuerAltName               = issuer:copy
##############################################################################
# extensions for subca when signing service certs as well as for users when
# requesting cert - man x509v3_config
# Same as above, but cert req already has SubjectAltName
[service_with_san_ext]
basicConstraints            = CA:false
nsCertType                  = server
nsComment                   = "Service Certificate"
keyUsage                    = critical, digitalSignature, keyEncipherment
subjectKeyIdentifier        = hash
#authorityKeyIdentifier      = keyid:always, issuer:always
crlDistributionPoints       = @subca_crl_uris
extendedKeyUsage            = serverAuth
# nameConstraints removed - RFC 5280 §4.2.1.10: must only appear in CA certs
#nameConstraints             = @service_nc
authorityInfoAccess         = @subca_issuer_info
#issuerAltName               = issuer:copy
##############################################################################
# extensions for subca when signing user certs as well as for users when
# requesting cert - man x509v3_config
[ user_ext ]
# User certs aren''t CAs, by definition
basicConstraints            = CA:false
# Here are some examples of the usage of nsCertType. If it is omitted
# the certificate can be used for anything *except* object signing.
# This is OK for an SSL server.
#nsCertType = server
# For an object signing certificate this would be used.
#nsCertType = objsign
# For normal client use this is typical
#nsCertType = client, email
# and for everything including object signing:
nsCertType                  = client, email, objsign
#
nsComment                   = "User Certificate"
# PKIX recommendations harmless if included in all certificates.
subjectKeyIdentifier        = hash
# PKIX recommendations harmless if included in all certificates.
authorityKeyIdentifier      = keyid:always, issuer:always
#
#
# SSL Client
# The extended key usage extension must be absent or include the
# "web client authentication" OID. keyUsage must be absent or it must have the
# digitalSignature bit set. Netscape certificate type must be absent or it must
# have the SSL client bit set.
#
# SSL Client CA
# The extended key usage extension must be absent or include the
# "web client authentication" OID. Netscape certificate type must be absent or
# it must have the SSL CA bit set: this is used as a work around if the
# basicConstraints extension is absent.
#
# SSL Server
# The extended key usage extension must be absent or include the
# "web server authentication" and/or one of the SGC OIDs. keyUsage must be
# absent or it must have the digitalSignature, the keyEncipherment set or both
# bits set. Netscape certificate type must be absent or have the SSL server bit
# set.
#
# SSL Server CA
# The extended key usage extension must be absent or include the
# "web server authentication" and/or one of the SGC OIDs. Netscape certificate
# type must be absent or the SSL CA bit must be set: this is used as a work
# around if the basicConstraints extension is absent.
#
# Netscape SSL Server
# For Netscape SSL clients to connect to an SSL server it must have the
# keyEncipherment bit set if the keyUsage extension is present. This isn''t
# always valid because some cipher suites use the key for digital signing.
# Otherwise it is the same as a normal SSL server.
#
# Common S/MIME Client Tests
# The extended key usage extension must be absent or include the
# "email protection" OID. Netscape certificate type must be absent or should
# have the S/MIME bit set. If the S/MIME bit is not set in Netscape certificate
# type then the SSL client bit is tolerated as an alternative but a warning is
# shown: this is because some Verisign certificates don''t set the S/MIME bit.
#
# S/MIME Signing
# In addition to the common S/MIME client tests the digitalSignature bit or the
# nonRepudiation bit must be set if the keyUsage extension is present.
#
# S/MIME Encryption
# In addition to the common S/MIME tests the keyEncipherment bit must be set if
# the keyUsage extension is present.
#
# S/MIME CA
# The extended key usage extension must be absent or include the
# "email protection" OID. Netscape certificate type must be absent or must have
# the S/MIME CA bit set: this is used as a work around if the basicConstraints
# extension is absent.
#
# CRL Signing
# The keyUsage extension must be absent or it must have the CRL signing bit set.
#
# CRL Signing CA
# The normal CA tests apply. Except in this case the basicConstraints extension
# must be present.
# This is typical in keyUsage for a client certificate.
# all usages -
# digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment,
# keyAgreement, keyCertSign, cRLSign, encipherOnly and decipherOnly.
# for more info see see https://www.openssl.org/docs/manmaster/man5/x509v3_config.html
#
# we want for users
# SSL Client
# Common S/MIME Client Tests
# S/MIME Signing
# S/MIME Encryption
keyUsage                    = critical, nonRepudiation, digitalSignature, keyEncipherment, dataEncipherment
# This extensions consists of a list of usages indicating purposes for which the
# certificate public key can be used for,
# These can either be object short names or the dotted numerical form of OIDs.
# While any OID can be used only certain values make sense. In particular the
# following PKIX, NS and MS values are meaningful:
# serverAuth             SSL/TLS Web Server Authentication.
# clientAuth             SSL/TLS Web Client Authentication.
# codeSigning            Code signing.
# emailProtection        E-mail Protection (S/MIME).
# timeStamping           Trusted Timestamping
# OCSPSigning            OCSP Signing
# ipsecIKE               ipsec Internet Key Exchange
# msCodeInd              Microsoft Individual Code Signing (authenticode)
# msCodeCom              Microsoft Commercial Code Signing (authenticode)
# msCTLSign              Microsoft Trust List Signing
# msEFS                  Microsoft Encrypted File System
# for more info see see https://www.openssl.org/docs/manmaster/man5/x509v3_config.html
extendedKeyUsage            = clientAuth, emailProtection
# crl distribution url
crlDistributionPoints       = @subca_crl_uris
# nameConstraints removed - RFC 5280 §4.2.1.10: must only appear in CA certs
#nameConstraints             = @user_nc
# ?
# authorityInfoAccess         = @ca_issuer_info
authorityInfoAccess         = @subca_issuer_info
# This stuff is for subjectAltName and issuerAltname.
# Import the email address.
#subjectAltName=email:copy
# An alternative to produce certificates that aren''t
# deprecated according to PKIX.
subjectAltName              = email:move
#issuerAltName               = issuer:copy
##############################################################################
# extensions for subca when signing user certs as well as for users when
# requesting cert - man x509v3_config
# Same as above, but cert req already has SubjectAltName
[ user_with_san_ext ]
basicConstraints            = CA:false
nsCertType                  = client, email, objsign
nsComment                   = "User Certificate"
keyUsage                    = critical, nonRepudiation, digitalSignature, keyEncipherment, dataEncipherment
subjectKeyIdentifier        = hash
#authorityKeyIdentifier      = keyid:always, issuer:always
crlDistributionPoints       = @subca_crls
extendedKeyUsage            = clientAuth, emailProtection
# nameConstraints removed - RFC 5280 §4.2.1.10: must only appear in CA certs
#nameConstraints             = @user_nc
authorityInfoAccess         = @subca_issuer_info
#issuerAltName               = issuer:copy
##############################################################################
# extension for OCSP signing certificates - man ocsp.
[ ocsp ]
#
basicConstraints            = critical, CA:false
#
subjectKeyIdentifier        = hash
#
authorityKeyIdentifier      = keyid:allways, issuer:allways
#
keyUsage                    = critical, digitalSignature
#
extendedKeyUsage            = critical, OCSPSigning
# ?
noCheck                     = yes
##############################################################################
# ca distinguished name
[ ca_dn ]
# short form C
# countryName                   = Country Name (2 letter code)
# countryName_default           = US
# countryName_min               = 2
# countryName_max               = 2
countryName                     = IL
# short form ST
# stateOrProvinceName           = State or Province Name (full name)
# stateOrProvinceName_default   = California
# stateOrProvinceName_min       = 2
# stateOrProvinceName_max                 = 2
stateOrProvinceName             = Gush Dan
# short form locality L
# localityName                    = Locality Name (eg, city)
# localityName_default            = Tel Aviv
localityName                    = Tel Aviv
# short form organization O
# 0.organizationName              = Organization Name (eg, company)
# 0.organizationName_default      = PhilNet
0.organizationName              = ${caps_name}
# short form OU
organizationalUnitName          = IT
# commonName - short form CN
# commonName                      = Common Name (eg, YOUR name)
# commonName_default              = ${common_name_prefix}CA
# commonName_max                  = 64
commonName                      = ${common_name_prefix}CA
# emailAddress - short form
# emailAddress                    = Email Address
# emailAddress_max                = 64
emailAddress                    = it@${full_domain}
##############################################################################
# subca distinguished name
[ subca_dn ]
# short form C
# countryName                   = Country Name (2 letter code)
# countryName_default           = US
# countryName_min               = 2
# countryName_max               = 2
countryName                     = IL
# short form ST
# stateOrProvinceName           = State or Province Name (full name)
# stateOrProvinceName_default   = California
# stateOrProvinceName_min       = 2
# stateOrProvinceName_max       = 2
stateOrProvinceName             = Gush Dan
# short form locality L
# localityName                    = Locality Name (eg, city)
# localityName_default            = Tel Aviv
localityName                    = Tel Aviv
# short form organization O
# 0.organizationName              = Organization Name (eg, company)
# 0.organizationName_default      = PhilNet
0.organizationName              = ${caps_name}
# short form OU
organizationalUnitName          = IT
# commonName - short form CN
# commonName                      = Common Name (eg, YOUR name)
# commonName_default              = ${common_name_prefix}CA
# commonName_max                  = 64
commonName                      = ${common_name_prefix}SubCA - ${subca}
# emailAddress - short form
# emailAddress                    = Email Address
# emailAddress_max                = 64
emailAddress                    = ${subca}@${full_domain}
#
name                            = ${subca_name}
#
surname                         = ${subca_surname}
#
givenName                       = ${subca_given_name}
#
initials                        = ${subca_initials}
#
#dnQualifier                     =
##############################################################################
# host distinguished name
[ host_dn ]
# short form C
# countryName                   = Country Name (2 letter code)
# countryName_default           = US
# countryName_min               = 2
# countryName_max               = 2
countryName                     = IL
# short form ST
# stateOrProvinceName           = State or Province Name (full name)
# stateOrProvinceName_default   = California
# stateOrProvinceName_min       = 2
# stateOrProvinceName_max       = 2
stateOrProvinceName             = Gush Dan
# short form locality L
# localityName                    = Locality Name (eg, city)
# localityName_default            = Tel Aviv
localityName                    = Tel Aviv
# short form organization O
# 0.organizationName              = Organization Name (eg, company)
# 0.organizationName_default      = PhilNet
0.organizationName              = ${caps_name}
# short form OU
organizationalUnitName          = IT
# commonName - short form CN
# commonName                      = Common Name (eg, YOUR name)
# commonName_default              = ${common_name_prefix}CA
# commonName_max                  = 64
commonName                      = ${common_name_prefix}Host - ${host}
# emailAddress - short form
# emailAddress                    = Email Address
# emailAddress_max                = 64
emailAddress                    = ${host}@${full_domain}
#
name                            = ${host}
#
#dnQualifier                     =
##############################################################################
# service distinguished name
[ service_dn ]
# short form C
# countryName                   = Country Name (2 letter code)
# countryName_default           = US
# countryName_min               = 2
# countryName_max               = 2
countryName                     = IL
# short form ST
# stateOrProvinceName           = State or Province Name (full name)
# stateOrProvinceName_default   = California
# stateOrProvinceName_min       = 2
# stateOrProvinceName_max       = 2
stateOrProvinceName             = Gush Dan
# short form locality L
# localityName                    = Locality Name (eg, city)
# localityName_default            = Tel Aviv
localityName                    = Tel Aviv
# short form organization O
# 0.organizationName              = Organization Name (eg, company)
# 0.organizationName_default      = PhilNet
0.organizationName              = ${caps_name}
# short form OU
organizationalUnitName          = IT
# commonName - short form CN
# commonName                      = Common Name (eg, YOUR name)
# commonName_default              = ${common_name_prefix}CA
# commonName_max                  = 64
commonName                      = ${service_dns_name}
# emailAddress - short form
# emailAddress                    = Email Address
# emailAddress_max                = 64
emailAddress                    = ${service}@${full_domain}
#
name                            = ${service}
#
#dnQualifier                     =
##############################################################################
# user distinguished name
[ user_dn ]
#
name                            = ${user_name}
#
surname                         = ${user_surname}
#
givenName                       = ${user_given_name}
#
initials                        = ${user_initials}
# short form C
# countryName                   = Country Name (2 letter code)
# countryName_default           = US
# countryName_min               = 2
# countryName_max               = 2
countryName                     = IL
# short form ST
# stateOrProvinceName           = State or Province Name (full name)
# stateOrProvinceName_default   = California
# stateOrProvinceName_min       = 2
# stateOrProvinceName_max       = 2
stateOrProvinceName             = Gush Dan
# short form locality L
# localityName                    = Locality Name (eg, city)
# localityName_default            = Tel Aviv
localityName                    = Tel Aviv
# short form organization O
# 0.organizationName              = Organization Name (eg, company)
# 0.organizationName_default      = PhilNet
0.organizationName              = ${caps_name}
# short form OU
organizationalUnitName          = IT
# commonName - short form CN
# commonName                      = Common Name (eg, YOUR name)
# commonName_default              = ${common_name_prefix}CA
# commonName_max                  = 64
commonName                      = ${common_name_prefix}User - ${user}
# emailAddress - short form
# emailAddress                    = Email Address
# emailAddress_max                = 64
emailAddress                    = ${user}@${full_domain}
#
#dnQualifier                     =
[ ca_alt_names ]
#
#DNS.1 = ${name}.org
#
#DNS.2 = ${name}.biz
[ subca_alt_names ]
#
#DNS.1 = ${name}.org
#
#DNS.2 = ${name}.biz
[ host_alt_names ]
#
#DNS.1 = ${name}.org
#
#DNS.2 = ${name}.biz
[ service_alt_names ]
#
DNS.1 = ${service_local_dns_name}
#
DNS.2 = ${service_dns_name}
#
[ user_alt_names ]
#
#DNS.1 = ${name}.org
#
#DNS.2 = ${name}.biz
##############################################################################
# ca request attributes
# we do not use it but it is necessary to declare it
[ ca_req_attributes ]
#challengePassword              = A challenge password
#challengePassword_min          = 4
#challengePassword_max          = 20
#unstructuredName               = An optional company name
##############################################################################
# subca request attributes
# we do not use it but it is necessary to declare it
[ subca_req_attributes ]
#challengePassword              = A challenge password
#challengePassword_min          = 4
#challengePassword_max          = 20
#unstructuredName               = An optional company name
##############################################################################
# host request attributes
# we do not use it but it is necessary to declare it
[ host_req_attributes ]
#challengePassword              = A challenge password
#challengePassword_min          = 4
#challengePassword_max          = 20
#unstructuredName               = An optional company name
##############################################################################
# service request attributes
# we do not use it but it is necessary to declare it
[ service_req_attributes ]
#challengePassword              = A challenge password
#challengePassword_min          = 4
#challengePassword_max          = 20
#unstructuredName               = An optional company name
##############################################################################
# user request attributes
# we do not use it but it is necessary to declare it
[ user_req_attributes ]
#challengePassword              = A challenge password
#challengePassword_min          = 4
#challengePassword_max          = 20
#unstructuredName               = An optional company name
########################################################################
# ca certificate self-signing request settings - see man req
[ ca_req ]
#
days                        = 36500
#
default_bits                = 3744
#
prompt                      = no
#
# This sets a mask for permitted string types. There are several options.
# default: PrintableString, T61String, BMPString.
# pkix   : PrintableString, BMPString.
# utf8only: only UTF8Strings.
# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
# MASK:XXXX a literal mask value.
# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
# so use this option with caution!
#string_mask                 = utf8only
# sha512 is deprecated, so use sha512 instead.
default_md                  = sha512
#
encrypt_key                 = yes
#
utf8                        = yes
#
default_keyfile             = ${ca_key_file}
# req attributes
attributes                  = ca_req_attributes
# in case one uses this request profile to sign a request, assume subca extensions
# The extensions to add to req''s
#req_extensions		          = subca_ext
# self signing extensions
x509_extensions             = ca_ext
#
distinguished_name          = ca_dn
#
subjectAltName              = @ca_alt_names
########################################################################
# subca certificate request settings - see man req
[ subca_req ]
#
days                        = 36500
#
default_bits                = 2048
#
prompt                      = no
#
# This sets a mask for permitted string types. There are several options.
# default: PrintableString, T61String, BMPString.
# pkix   : PrintableString, BMPString.
# utf8only: only UTF8Strings.
# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
# MASK:XXXX a literal mask value.
# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
# so use this option with caution!
string_mask                 = utf8only
# sha512 is deprecated, so use sha512 instead.
default_md                  = sha512
#
encrypt_key                 = yes
#
utf8                        = yes
#
default_keyfile             = ${subca_key_file}
# req attributes
attributes                  = subca_req_attributes
# in case one uses this request profile to sign a request, assume subca extensions
# The extensions to add to req''s
# we default to service extensions for subca signing requests
# req_extensions		          = subca_ext
# self signing extensions - shuld not be relevant here
# x509_extensions             = ca_ext
#
distinguished_name          = subca_dn
#
subjectAltName              = @subca_alt_names
########################################################################
# host certificate request settings - see man req
[ host_req ]
#
days                        = 36500
#
default_bits                = 2048
#
prompt                      = no
#
# This sets a mask for permitted string types. There are several options.
# default: PrintableString, T61String, BMPString.
# pkix   : PrintableString, BMPString.
# utf8only: only UTF8Strings.
# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
# MASK:XXXX a literal mask value.
# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
# so use this option with caution!
string_mask                 = utf8only
# sha1 is deprecated, so use sha512 instead.
default_md                  = sha512
#
encrypt_key                 = yes
#
utf8                        = yes
#
default_keyfile             = ${host_key_file}
# req attributes
attributes                  = host_req_attributes
# in case one uses this request profile to sign a request, assume subca extensions
# The extensions to add to req''s
req_extensions		          = host_ext
# self signing extensions - should not be relevant here
# x509_extensions             = host_ext
#
distinguished_name          = host_dn
#
subjectAltName              = @host_alt_names
########################################################################
# service certificate request settings - see man req
[ service_req ]
#
days                        = 36500
#
default_bits                = 2048
#
prompt                      = no
#
# This sets a mask for permitted string types. There are several options.
# default: PrintableString, T61String, BMPString.
# pkix   : PrintableString, BMPString.
# utf8only: only UTF8Strings.
# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
# MASK:XXXX a literal mask value.
# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
# so use this option with caution!
string_mask                 = utf8only
# sha512 is deprecated, so use sha512 instead.
default_md                  = sha512
#
encrypt_key                 = yes
#
utf8                        = yes
#
default_keyfile             = ${service_key_file}
# req attributes
attributes                  = service_req_attributes
# in case one uses this request profile to sign a request, assume subca extensions
# The extensions to add to req''s
req_extensions		          = service_ext
# self signing extensions - should not be relevant here
# x509_extensions             = ca_ext
#
distinguished_name          = service_dn
#
subjectAltName              = @service_alt_names
########################################################################
# user certificate request settings - see man req
[ user_req ]
#
days                        = 36500
#
default_bits                = 2048
#
prompt                      = no
#
# This sets a mask for permitted string types. There are several options.
# default: PrintableString, T61String, BMPString.
# pkix   : PrintableString, BMPString.
# utf8only: only UTF8Strings.
# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
# MASK:XXXX a literal mask value.
# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
# so use this option with caution!
string_mask                 = utf8only
# sha512 is deprecated, so use sha512 instead.
default_md                  = sha512
#
encrypt_key                 = yes
#
utf8                        = yes
#
default_keyfile             = ${user_key_file}
# req attributes
attributes                  = user_req_attributes
# in case one uses this request profile to sign a request, assume subca extensions
# The extensions to add to req''s
req_extensions		          = user_with_san_ext
# self signing extensions - should make no sense here
# x509_extensions             = ca_ext
#
distinguished_name          = user_dn
#
subjectAltName              = @user_alt_names
